FROM ansibleplaybookbundle/apb-base:canary
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"LS0tCgp2ZXJzaW9uOiAxLjAKbmFtZTogb3BlbnN0YWNrLXRyb3ZlLWFwYgpkZXNjcmlwdGlvbjog\
IE9wZW5zdGFjayBUcm92ZSBhcGIgaW1wbGVtZW50YXRpb24KYmluZGFibGU6IGZhbHNlCmFzeW5j\
OiBvcHRpb25hbAp0YWdzOgogIC0gcXVldWUKbWV0YWRhdGE6CiAgZG9jdW1lbnRhdGlvblVybDog\
aHR0cHM6Ly93aWtpLm9wZW5zdGFjay5vcmcvd2lraS9Ucm92ZSAKICBsb25nRGVzY3JpcHRpb246\
IEFuIGFwYiB0aGF0IGRlcGxveXMgYW4gb3BlbnN0YWNrIFRyb3ZlIERCCiAgZGlzcGxheU5hbWU6\
IE9wZW5zdGFjayBUcm92ZSAoQVBCKQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczog\
aWNvbi1vcGVuc3RhY2sKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxh\
bnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogQSBzaW5nbGUgVHJvdmUgREIK\
ICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGVmYXVsdAog\
ICAgICBsb25nRGVzY3JpcHRpb246IFRoaXMgcGxhbiBwcm92aWRlcyBhIHNpbmdsZSBPcGVuc3Rh\
Y2sgVHJvdmUgREIKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFt\
ZTogZGF0YXN0b3JlX3R5cGUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogRGF0\
YXN0b3JlIFR5cGUKICAgICAgICBkZXNjcmlwdGlvbjogVHlwZSBvZiBEYXRhc3RvcmUKICAgICAg\
ICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGRhdGFzdG9yZV92ZXJzaW9uCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IERhdGFzdG9yZSBWZXJzaW9uCiAgICAgICAgZGVz\
Y3JpcHRpb246IFZlcnNpb24gb2YgRGF0YXN0b3JlCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAg\
ICAgLSBuYW1lOiBmbGF2b3IKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogSW5z\
dGFuY2UgRmxhdm9yCiAgICAgICAgZGVzY3JpcHRpb246IFR5cGUgb2YgaW5zdGFuY2UgKGZsYXZv\
cikgdG8gYmUgdXNlZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogc2l6ZQog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBTaXplCiAgICAgICAgZGVzY3JpcHRp\
b246IFNpemUgb2YgdGhlIERhdGFzdG9yZSB2b2x1bWUgaW4gR0IKICAgICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICAtIG5hbWU6IG5ldHdvcmtfbmFtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIHRpdGxlOiBOZXR3b3JrIE5hbWUKICAgICAgICBkZXNjcmlwdGlvbjogTmFtZSBvZiB0aGUg\
bmV0d29yayB0byBjb25uZWN0IHRoZSBEQiB0bwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
IC0gbmFtZTogZGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogRGF0\
YWJhc2UKICAgICAgICBkZXNjcmlwdGlvbjogTmFtZSBvZiB0aGUgZGF0YWJhc2UgdG8gYmUgY3Jl\
YXRlZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogZGF0YWJhc2VfdXNlcgog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBVc2VyCiAgICAgICAg\
ZGVzY3JpcHRpb246IE5hbWUgb2YgdGhlIGRhdGFiYXNlIHVzZXIKICAgICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICAtIG5hbWU6IGRhdGFiYXNlX3Bhc3MKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICB0aXRsZTogRGF0YWJhc2UgUGFzc3dvcmQKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3\
b3JkCiAgICAgICAgZGVzY3JpcHRpb246IFBhc3N3b3JkIGZvciB0aGUgZGF0YWJhc2UgdXNlcgog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogdXNlcgogICAgICAgIHRpdGxlOiBV\
c2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBk\
aXNwbGF5X2dyb3VwOiAiT3BlbnN0YWNrIEF1dGhlbnRpY2F0aW9uIgogICAgICAtIG5hbWU6IHBh\
c3MKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogUGFzc3dvcmQKICAgICAgICBy\
ZXF1aXJlZDogdHJ1ZQogICAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgICBkaXNw\
bGF5X2dyb3VwOiAiT3BlbnN0YWNrIEF1dGhlbnRpY2F0aW9uIgogICAgICAtIG5hbWU6IHByb2pl\
Y3QKICAgICAgICB0aXRsZTogUHJvamVjdAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJl\
cXVpcmVkOiB0cnVlCiAgICAgICAgZGlzcGxheV9ncm91cDogIk9wZW5zdGFjayBBdXRoZW50aWNh\
dGlvbiIKICAgICAgLSBuYW1lOiB1cmwKICAgICAgICB0aXRsZTogSWRlbnRpdHkgVVJMCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkaXNwbGF5X2dy\
b3VwOiAiT3BlbnN0YWNrIEF1dGhlbnRpY2F0aW9uIgo="


RUN pip install shade

ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/openstack-trove-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
